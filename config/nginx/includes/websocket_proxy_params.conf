# config/nginx/includes/websocket_proxy_params.conf
# ENHANCED - WebSocket-Specific Proxy Parameters

# Include base proxy settings
include /etc/nginx/includes/proxy_params.conf;

#=================================
# WEBSOCKET PROTOCOL SETTINGS
#=================================

# Use HTTP/1.1 for WebSocket protocol
# proxy_http_version 1.1;  # Already defined in proxy_params.conf

# Essential WebSocket upgrade headers
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection $connection_upgrade;

#=================================
# WEBSOCKET-SPECIFIC HEADERS
#=================================

# WebSocket handshake headers
proxy_set_header Sec-WebSocket-Extensions $http_sec_websocket_extensions;
proxy_set_header Sec-WebSocket-Key $http_sec_websocket_key;
proxy_set_header Sec-WebSocket-Version $http_sec_websocket_version;
proxy_set_header Sec-WebSocket-Protocol $http_sec_websocket_protocol;

# Application-level headers
proxy_set_header Origin $http_origin;

#=================================
# WEBSOCKET OPTIMIZATIONS
#=================================

# Extended timeouts for persistent connections (24 hours)
# proxy_read_timeout 86400s;  # Already defined in proxy_params.conf
# proxy_send_timeout 86400s;  # Already defined in proxy_params.conf

# Disable buffering for real-time traffic
# proxy_buffering off;  # Already defined in proxy_params.conf
# proxy_request_buffering off;  # Already defined in proxy_params.conf

# Bypass cache for WebSocket connections
proxy_cache_bypass $http_upgrade;