# /etc/nginx/includes/security_headers.conf
# ENHANCED - Security Headers Configuration

#=================================
# CORE SECURITY HEADERS
#=================================

# X-Frame-Options - Prevent clickjacking
# Use maps variable if available, otherwise fallback to static value
add_header X-Frame-Options $x_frame_options always;

# X-Content-Type-Options - Prevent MIME type sniffing
add_header X-Content-Type-Options $x_content_type_options always;

# X-XSS-Protection - Enable XSS filtering
add_header X-XSS-Protection $x_xss_protection always;

# Referrer Policy - Control referrer information
add_header Referrer-Policy $referrer_policy always;

#=================================
# CONTENT SECURITY POLICY
#=================================

# Use CSP from maps configuration
add_header Content-Security-Policy $content_security_policy always;

#=================================
# TRANSPORT SECURITY
#=================================

# HSTS - Force HTTPS (only add when using HTTPS)
# Use static value for max security
add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;

#=================================
# ADDITIONAL SECURITY HEADERS
#=================================

# Permissions Policy - Control browser features
add_header Permissions-Policy "accelerometer=(), camera=(), geolocation=(), gyroscope=(), magnetometer=(), microphone=(), payment=(), usb=()" always;

# Cross-domain policies
add_header X-Permitted-Cross-Domain-Policies "none" always;

# Download options for IE
add_header X-Download-Options "noopen" always;

# SEO/Crawling control
add_header X-Robots-Tag "noindex, nofollow, nosnippet, noarchive" always;